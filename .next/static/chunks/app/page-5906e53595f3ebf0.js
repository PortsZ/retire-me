(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{6190:function(e,t,a){Promise.resolve().then(a.bind(a,2413))},2413:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return N}});var r=a(7437),s=a(2265),l=a(4903),o=a(5127),d=a(7138),i=a(2126);let n="http://127.0.0.1:3000",c=async e=>(await i.Z.get("".concat(n,"/api/portfolio/stock/").concat(e))).data,b=async(e,t,a)=>(await i.Z.post("".concat(n,"/api/portfolio/stock"),{userId:e,symbol:t,quantity:a})).data,p=async(e,t,a)=>(await i.Z.put("".concat(n,"/api/portfolio/stock"),{userId:e,symbol:t,quantity:a})).data,x=async(e,t)=>(await i.Z.delete("".concat(n,"/api/portfolio/stock"),{data:{userId:e,symbol:t}})).data,u=async e=>{let t=await i.Z.post("".concat(n,"/api/portfolio/rebalance"),{stocks:e});return console.log(t.data),t.data},m=[{name:"Me Aposenta!",url:"/retire",description:"Calculadora de Liberdade Financeira",style:"from-sky-300 to-sky-500"},{name:"Calculadora de Financiamento",url:"/financing",description:"Calcule qualquer incognita do seu financiamento com apenas 3 dados",style:"from-lime-400 to-green-500"},{name:"Assistente de Cria\xe7\xe3o de Portf\xf3lio",description:"Em breve!",enabled:"disabled",disabledMessage:"Em breve!",disabledStyle:"from-slate-100 to-slate-400 opacity-60 cursor-not-allowed"},{name:"Rebalanceamento de Portf\xf3lio",description:"Gerencie seu portfolio",style:"from-fuchsia-500 to-rose-400 cursor-not-allowed"}];var y=e=>{let{sessionData:t}=e,[a,i]=(0,s.useState)(null),[n,b]=(0,s.useState)(null),[p,x]=(0,s.useState)(null),y=async e=>{i(await g()),b(e)},g=async()=>{let e=await c(t.user.id),a={};return e.forEach(e=>{a[e.symbol]=e.quantity}),a};return(0,s.useEffect)(()=>{a&&u(a).then(e=>{x(e)})},[a]),(0,r.jsx)("div",{className:"grid grid-cols-2 gap-2 p-2",children:m.map((e,t)=>"Rebalanceamento de Portf\xf3lio"===e.name?(0,r.jsxs)(s.Fragment,{children:[(0,r.jsxs)(l.E.div,{whileHover:{scale:1.02},whileTap:{scale:.98},layoutId:t.toString(),className:"".concat(e.style," p-4 text-black bg-gradient-to-tr rounded-lg cursor-pointer select-none"),onClick:()=>y(t),children:[(0,r.jsx)("h3",{className:"text-xl font-medium",children:e.name}),(0,r.jsx)("p",{className:"text-slate-900 italic",children:e.description})]}),(0,r.jsx)(o.M,{children:n&&(0,r.jsx)(l.E.div,{onClick:()=>{b(null),x(null)},className:" bg-black bg-opacity-30 backdrop-blur-xl fixed top-0 right-0 left-0 bottom-0  flex justify-center items-center",children:(0,r.jsxs)(l.E.div,{layoutId:n,onClick:e=>e.stopPropagation(),className:"flex p-20 justify-center items-center flex-col rounded bg-gradient-to-tr from-fuchsia-500 to-rose-400",children:[!p&&(0,r.jsx)("div",{className:"animate-pulse",children:"Loading ..."}),p&&(0,r.jsx)("div",{className:"overflow-x-auto w-full rounded",children:(0,r.jsxs)("table",{className:"min-w-full leading-normal rounded",children:[(0,r.jsx)("thead",{className:"",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-5 py-3 border-b-2 border-gray-300 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Symbol"}),(0,r.jsx)("th",{className:"px-5 py-3 border-b-2 border-gray-300 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Adjusted Market Values"}),(0,r.jsx)("th",{className:"px-5 py-3 border-b-2 border-gray-300 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Adjusted Quantities"}),(0,r.jsx)("th",{className:"px-5 py-3 border-b-2 border-gray-300 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Sharpe Ratios"}),(0,r.jsx)("th",{className:"px-5 py-3 border-b-2 border-gray-300 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Weights"})]})}),(0,r.jsx)("tbody",{className:"text-gray-600 text-right",children:Object.keys(p.portfolio["Adjusted Market Values"]).map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:"text-left px-5 py-5 border-b border-gray-200 bg-white text-sm",children:e}),(0,r.jsx)("td",{className:"px-5 py-5 border-b border-gray-200 bg-white text-sm",children:p.portfolio["Adjusted Market Values"][e].toFixed(2)}),(0,r.jsx)("td",{className:"px-5 py-5 border-b border-gray-200 bg-white text-sm",children:p.portfolio["Adjusted Quantities"][e]}),(0,r.jsx)("td",{className:"px-5 py-5 border-b border-gray-200 bg-white text-sm",children:p.portfolio["Sharpe Ratios"][e].toFixed(4)}),(0,r.jsx)("td",{className:"px-5 py-5 border-b border-gray-200 bg-white text-sm",children:p.portfolio.Weights[e]})]},e))}),(0,r.jsx)("tfoot",{children:(0,r.jsx)("tr",{children:(0,r.jsxs)("td",{colSpan:5,className:"px-5 py-5 border-b border-gray-200 bg-white text-slate-600 text-sm font-bold",children:["Total Adjusted Market Value:"," ",p.total_adjusted_market_value.toFixed(2)]})})})]})})]})})})]},t):(0,r.jsx)(d.default,{href:e.url?e.url:"#",children:(0,r.jsxs)(l.E.div,{whileHover:{scale:1.02},whileTap:{scale:.98},className:"".concat("disabled"===e.enabled?e.disabledStyle:e.style," p-4 text-black bg-gradient-to-tr rounded-lg cursor-pointer select-none"),children:[(0,r.jsx)("h3",{className:"text-xl font-medium",children:e.name}),(0,r.jsx)("p",{className:"text-slate-900 italic",children:e.description})]})},t))})},g=e=>{let{portfolio:t,total:a,setPortfolio:l,userId:o}=e,[d,i]=(0,s.useState)(null),[n,c]=(0,s.useState)({}),b=(e,t)=>{i(e),c({...n,[t.symbol]:t.quantity})},u=(e,t)=>{c({...n,[e]:t})},m=async e=>{let t=n[e];await p(o,e,t),i(null),l(a=>a.map(a=>a.symbol===e?{...a,quantity:t}:a))},y=async e=>{await x(o,e),l(t=>t.filter(t=>t.symbol!==e))};return(0,r.jsx)("div",{className:"w-full overflow-x-auto bg-gray-800 rounded",children:(0,r.jsxs)("table",{className:"w-full text-left border-collapse text-gray-200 rounded",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"bg-gray-700",children:[(0,r.jsx)("th",{className:"px-4 py-2 border-b border-gray-600",children:"Symbol"}),(0,r.jsx)("th",{className:"px-4 py-2 border-b border-gray-600",children:"Price"}),(0,r.jsx)("th",{className:"px-4 py-2 border-b border-gray-600",children:"Quantity"}),(0,r.jsx)("th",{className:"px-4 py-2 border-b border-gray-600",children:"Total $"}),(0,r.jsx)("th",{className:"px-4 py-2 border-b border-gray-600",children:"Actions"})]})}),(0,r.jsxs)("tbody",{children:[t.map((e,t)=>(0,r.jsxs)("tr",{className:"hover:bg-gray-600",children:[(0,r.jsx)("td",{className:"px-4 py-2 border-b border-gray-600",children:e.symbol}),(0,r.jsx)("td",{className:"px-4 py-2 border-b border-gray-600",children:e.price}),(0,r.jsx)("td",{className:"px-4 py-2 border-b border-gray-600",children:d===t?(0,r.jsx)("input",{type:"number",className:"bg-gray-700 p-2 rounded",value:n[e.symbol]||e.quantity,onChange:t=>u(e.symbol,parseInt(t.target.value,10))}):e.quantity}),(0,r.jsx)("td",{className:"px-4 py-2 border-b border-gray-600",children:(e.price*e.quantity).toFixed(2)}),(0,r.jsx)("td",{className:"px-4 py-2 border-b border-gray-600",children:d===t?(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{onClick:()=>m(e.symbol),className:"rounded bg-gradient-to-tr from-blue-500 to-sky-500 text-black px-4 p-2",children:"Update"}),(0,r.jsx)("button",{onClick:()=>i(null),className:"bg-gray-500 hover:bg-gray-700 text-white font-bold py-1 px-2 rounded",children:"Cancel"})]}):(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{onClick:()=>b(t,e),className:"rounded bg-gradient-to-tr from-lime-500 to-green-500 text-black px-4 p-2",children:"Edit"}),(0,r.jsx)("button",{onClick:()=>y(e.symbol),className:"bg-red-500 hover:bg-red-700 text-white font-bold py-1 px-2 rounded",children:"Delete"})]})})]},t)),(0,r.jsxs)("tr",{className:"bg-gray-700 font-bold",children:[(0,r.jsx)("td",{className:"px-4 py-2 border-b border-gray-600",colSpan:3,children:"Total Portfolio Value"}),(0,r.jsx)("td",{className:"text-center px-4 py-2 border-b border-gray-600",colSpan:2,children:a.toFixed(2)})]})]})]})})},h=a(998),f=a(9343),j=()=>{let[e,t]=(0,s.useState)([]),[a,l]=(0,s.useState)(0),[o,d]=(0,s.useState)(!0),[n,c]=(0,s.useState)(!1),{register:p,handleSubmit:x}=(0,f.cI)(),{data:u}=(0,h.useSession)(),[m,y]=(0,s.useState)(null);(0,s.useEffect)(()=>{u&&o&&u.user&&u.stocks&&(y(u.user.id),Promise.all(u.stocks.map(e=>j(e.symbol.toUpperCase()).then(t=>({symbol:e.symbol.toUpperCase(),price:t.price,quantity:e.quantity})))).then(e=>{t(e),d(!1),c(!0)}))},[u,o]),(0,s.useEffect)(()=>{n&&(c(!1),w())},[n,e]);let j=async e=>(await i.Z.post("".concat("http://127.0.0.1:3000","/api/lookup"),{symbol:e.toUpperCase()})).data,N=async a=>{console.log("data:",a.symbol);let r=await j(a.symbol);if(r){console.log("data:",r);let s=r.symbol.toUpperCase(),l=parseInt(a.quantity),o=await b(m,s,l);console.log("addToDbRes:",o),o&&(t([...e,{symbol:o.symbol.toUpperCase(),price:r.price,quantity:o.quantity}]),w(),console.log("portfolio:",e))}},w=()=>{let t=0;e.forEach(e=>{t+=e.price*e.quantity}),l(t)};return(0,s.useEffect)(()=>{w()},[e]),(0,r.jsxs)("div",{className:"flex flex-col gap-10 w-full",children:[(0,r.jsxs)("form",{onSubmit:x(N),className:"w-full flex flex-col gap-2",children:[(0,r.jsx)("h1",{className:"text-xl font-bold text-left",children:"Portfolio"}),(0,r.jsx)("input",{className:"bg-gray-700 p-2 rounded",type:"text",placeholder:"Stock Symbol",...p("symbol",{required:!0})}),(0,r.jsxs)("div",{className:"w-full flex gap-3",children:[(0,r.jsx)("input",{className:"bg-gray-700 p-2 rounded w-full",type:"number",placeholder:"Quantity",...p("quantity",{required:!0})}),(0,r.jsx)("button",{className:"rounded bg-gradient-to-tr from-lime-500 to-green-500 text-black px-4 p-2",type:"submit",children:"Add"})]})]}),u&&(0,r.jsx)(g,{portfolio:e,total:a,setPortfolio:t,userId:u.user.id})]})};function N(){let{status:e,data:t}=(0,h.useSession)(),a=async()=>{console.log("data: "+(await i.Z.get("/api/test")).data)};return(0,s.useEffect)(()=>{a()},[e]),(0,r.jsxs)("main",{className:"flex flex-col items-center justify-start p-24 gap-10 ",children:["authenticated"===e&&(0,r.jsx)("section",{className:"flex min-w-[50%] xl:p-16 md:p-10 p-8 bg-slate-900 rounded-xl",children:(0,r.jsx)(j,{})}),(0,r.jsx)("section",{children:(0,r.jsx)(y,{sessionData:t})})]})}}},function(e){e.O(0,[343,998,903,126,483,971,23,744],function(){return e(e.s=6190)}),_N_E=e.O()}]);